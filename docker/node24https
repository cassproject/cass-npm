FROM node:24
WORKDIR code
COPY package.json package.json
RUN npm install undici@six

COPY ca.crt ca.crt
COPY client.crt client.crt
COPY client.key client.key
COPY index.js index.js
COPY src src
COPY ca.crt ca.crt
COPY client.crt client.crt
COPY client.key client.key
ENV CASS_LOOPBACK=https://docker.host.internal/api/
ENTRYPOINT npm run mocha:clientSideCertificates